# ๐ FLUJO DE TRABAJO DEL SISTEMA

## Diagrama del Proceso

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    USUARIO                                       โ
โ  1. Coloca archivos de audio en la carpeta input/               โ
โ  2. Ejecuta: .\run.ps1                                           โ
โ  3. Selecciona opciรณn del menรบ interactivo                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                            โ
                            โ Menรบ Interactivo
                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                  CONTENEDOR DOCKER                               โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ  โ  1. CARGA DE MODELO WHISPER                               โ  โ
โ  โ     - Descarga modelo si no existe (primera vez)          โ  โ
โ  โ     - Carga modelo en memoria                             โ  โ
โ  โโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ                      โ                                           โ
โ                      โ                                           โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ  โ  2. ESCANEO DE ARCHIVOS                                   โ  โ
โ  โ     - Busca archivos de audio en input/                   โ  โ
โ  โ     - Identifica formatos: mp3, wav, m4a, etc.            โ  โ
โ  โโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ                      โ                                           โ
โ                      โ                                           โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ  โ  3. TRANSCRIPCIรN (Para cada archivo)                     โ  โ
โ  โ     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ           โ  โ
โ  โ     โ a) FFmpeg procesa el audio              โ           โ  โ
โ  โ     โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ           โ  โ
โ  โ                    โ                                       โ  โ
โ  โ     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ           โ  โ
โ  โ     โ b) Whisper transcribe a texto           โ           โ  โ
โ  โ     โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ           โ  โ
โ  โ                    โ                                       โ  โ
โ  โ     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ           โ  โ
โ  โ     โ c) Guarda transcripciรณn bรกsica          โ           โ  โ
โ  โ     โ    - nombre_transcripcion.txt           โ           โ  โ
โ  โ     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ           โ  โ
โ  โ                    โ                                       โ  โ
โ  โ     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ           โ  โ
โ  โ     โ d) Guarda transcripciรณn detallada       โ           โ  โ
โ  โ     โ    - nombre_transcripcion_detallada.txt โ           โ  โ
โ  โ     โ    - Incluye timestamps                 โ           โ  โ
โ  โ     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ           โ  โ
โ  โโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ                      โ                                           โ
โ                      โ                                           โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ  โ  4. FORMATEO CON OLLAMA (100% Local)                     โ  โ
โ  โ     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ           โ  โ
โ  โ     โ a) Lee transcripciรณn cruda              โ           โ  โ
โ  โ     โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ           โ  โ
โ  โ                    โ                                       โ  โ
โ  โ     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ           โ  โ
โ  โ     โ b) Envรญa a Ollama (llama3.2:3b)         โ           โ  โ
โ  โ     โ    - Servicio local en puerto 11434     โ           โ  โ
โ  โ     โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ           โ  โ
โ  โ                    โ                                       โ  โ
โ  โ     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ           โ  โ
โ  โ     โ c) Recibe texto formateado              โ           โ  โ
โ  โ     โ    - Pรกrrafos estructurados             โ           โ  โ
โ  โ     โ    - Puntuaciรณn corregida               โ           โ  โ
โ  โ     โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ           โ  โ
โ  โ                    โ                                       โ  โ
โ  โ     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ           โ  โ
โ  โ     โ d) Guarda texto formateado              โ           โ  โ
โ  โ     โ    - nombre_transcripcion_formateado.txtโ           โ  โ
โ  โ     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ           โ  โ
โ  โโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ                      โ                                           โ
โ                      โ                                           โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ  โ  5. ANรLISIS AVANZADO CON OLLAMA                          โ  โ
โ  โ     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ           โ  โ
โ  โ     โ a) Genera resumen ejecutivo             โ           โ  โ
โ  โ     โ    - nombre_resumen.txt                 โ           โ  โ
โ  โ     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ           โ  โ
โ  โ     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ           โ  โ
โ  โ     โ b) Extrae puntos clave                  โ           โ  โ
โ  โ     โ    - nombre_puntos_clave.txt            โ           โ  โ
โ  โ     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ           โ  โ
โ  โ     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ           โ  โ
โ  โ     โ c) Identifica temas principales         โ           โ  โ
โ  โ     โ    - nombre_temas.txt                   โ           โ  โ
โ  โ     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ           โ  โ
โ  โโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ                      โ                                           โ
โ                      โ                                           โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ  โ  5. LOGS Y FINALIZACIรN                                   โ  โ
โ  โ     - Guarda logs en logs/                                โ  โ
โ  โ     - Reporta estadรญsticas                                โ  โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                            โ
                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    RESULTADOS EN output/                         โ
โ  Por cada audio se generan hasta 6 archivos:                    โ
โ  - archivo_transcripcion.txt (Whisper bรกsico)                    โ
โ  - archivo_transcripcion_detallada.txt (con timestamps)          โ
โ  - archivo_transcripcion_formateado.txt (Ollama)                 โ
โ  - archivo_resumen.txt (Ollama anรกlisis)                         โ
โ  - archivo_puntos_clave.txt (Ollama anรกlisis)                    โ
โ  - archivo_temas.txt (Ollama anรกlisis)                           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ๐ฏ Modos de Ejecuciรณn

### Modo 1: FULL (completo) - Por defecto
```env
MODE=full
```
- โ Transcribe audio โ texto
- โ Formatea texto con Gemini
- ๐ค Genera: bรกsico + detallado + formateado

### Modo 2: TRANSCRIBE-ONLY (solo transcribir)
```env
MODE=transcribe-only
```
- โ Transcribe audio โ texto
- โ No formatea
- ๐ค Genera: bรกsico + detallado

### Modo 3: FORMAT-ONLY (solo formatear)
```env
MODE=format-only
```
- โ No transcribe
- โ Formatea transcripciones existentes en output/
- ๐ค Genera: formateado

## ๐ Mapeo de Directorios

```
HOST (tu PC)                    CONTENEDOR DOCKER
โโโโโโโโโโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโโโโโโโ
./input/                    โ   /app/input/
  โโโ audio.mp3                   โโโ audio.mp3

./output/                   โโ  /app/output/
  โโโ audio_transcripcion.txt
  โโโ audio_transcripcion_detallada.txt
  โโโ audio_transcripcion_formateado.txt

./logs/                     โโ  /app/logs/
  โโโ main.log
  โโโ transcription.log
  โโโ formatting.log
```

## โ๏ธ Variables de Configuraciรณn (.env)

```
โโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Variable            โ Descripciรณn                              โ
โโโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ MODE                โ full / transcribe-only / format-only     โ
โ WHISPER_MODEL       โ tiny / base / small / medium / large     โ
โ AUDIO_LANGUAGE      โ es / en / fr / ... (cรณdigo ISO)          โ
โ AUDIO_DIALECT       โ cl / mx / ar / es (variante regional)    โ
โ FORMATTER           โ ollama / gemini (motor de formateo)      โ
โ OLLAMA_MODEL        โ llama3.2:3b (modelo local por defecto)   โ
โ ENABLE_SUMMARY      โ true / false (generar resumen)           โ
โ ENABLE_KEY_POINTS   โ true / false (puntos clave)              โ
โ ENABLE_TOPICS       โ true / false (temas principales)         โ
โโโโโโโโโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ๐ Arquitectura de Componentes

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    main.py                              โ
โ              (Orquestador Principal)                    โ
โ  - Coordina transcripciรณn y formateo                    โ
โ  - Maneja configuraciรณn y logs                          โ
โ  - Integraciรณn con dialectos regionales                 โ
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโ
             โ                            โ
             โ                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ   transcribe.py        โ    โ   format_ollama.py       โ
โ   (Motor Whisper)      โ    โ   (Motor Ollama Local)   โ
โ                        โ    โ                          โ
โ - AudioTranscriber     โ    โ - OllamaFormatter        โ
โ - load_model()         โ    โ - format_text()          โ
โ - transcribe_file()    โ    โ - generate_summary()     โ
โ - DIALECT_PROMPTS      โ    โ - extract_key_points()   โ
โ - Optimizaciรณn chilena โ    โ - identify_topics()      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโฌโโโโโโโโโโโโโโโโ
                                         โ
                                         โ
                              โโโโโโโโโโโโโโโโโโโโโโโโ
                              โ  Servicio Ollama     โ
                              โ  (Puerto 11434)      โ
                              โ  llama3.2:3b (2GB)   โ
                              โ  100% Local          โ
                              โโโโโโโโโโโโโโโโโโโโโโโโ
```

## ๐ฆ Estados del Sistema

```
โโโโโโโโโโโโโโโ
โ   INICIO    โ
โโโโโโโโฌโโโโโโโ
       โ
       โ
โโโโโโโโโโโโโโโ      โ Error
โ Verificar   โโโโโโโโโโโโโโโโ SALIR
โ Docker      โ
โโโโโโโโฌโโโโโโโ
       โ โ
       โ
โโโโโโโโโโโโโโโ      โ Error
โ Construir   โโโโโโโโโโโโโโโโ SALIR
โ Imagen      โ
โโโโโโโโฌโโโโโโโ
       โ โ
       โ
โโโโโโโโโโโโโโโ      โ๏ธ  Advertencia
โ Cargar      โโโโโโโโโโโโโโโโ Continuar
โ Modelo      โ
โโโโโโโโฌโโโโโโโ
       โ โ
       โ
โโโโโโโโโโโโโโโ      โ๏ธ  Sin archivos
โ Escanear    โโโโโโโโโโโโโโโโ SALIR
โ Input       โ
โโโโโโโโฌโโโโโโโ
       โ โ
       โ
โโโโโโโโโโโโโโโ
โ Transcribir โ
โ Archivos    โ
โโโโโโโโฌโโโโโโโ
       โ
       โ
โโโโโโโโโโโโโโโ      โ๏ธ  Sin API key
โ Formatear   โโโโโโโโโโโโโโโโ SALTAR
โ (Opcional)  โ
โโโโโโโโฌโโโโโโโ
       โ โ
       โ
โโโโโโโโโโโโโโโ
โ COMPLETADO  โ
โโโโโโโโโโโโโโโ
```

## ๐ Tiempo de Procesamiento Estimado

Para un archivo de **1 hora de audio**:

```
Modelo      CPU (4 cores)    GPU (NVIDIA)    Calidad
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
tiny        ~5 minutos       ~2 minutos      โโโโโ
base        ~7 minutos       ~3 minutos      โโโโโ
small       ~10 minutos      ~4 minutos      โโโโโ (Recomendado)
medium      ~20 minutos      ~7 minutos      โโโโโ
large       ~40 minutos      ~12 minutos     โโโโโ
```

**Formateo con Ollama (llama3.2:3b):**
- Formateo bรกsico: ~30-60 segundos
- Anรกlisis completo (resumen + puntos + temas): ~2-3 minutos
- **100% local, sin lรญmites de API**

## ๐ Flujo de Seguridad y Privacidad

```
๐จ๐ฑ Audios en espaรฑol chileno
       โ
  Procesados con Whisper + dialectos locales
       โ
  Formateo 100% LOCAL con Ollama (llama3.2:3b)
       โ
  Todo dentro de contenedores Docker (aislado)
       โ
  Sin envรญo de datos a internet (PRIVACIDAD TOTAL)
       โ
  Archivos permanecen en tu PC (./output/)
       โ
  Logs locales, sin tracking externo
```

**Ventajas:**
- โ Sin API keys necesarias
- โ Sin lรญmites de uso
- โ Sin costos por procesamiento
- โ Datos nunca salen de tu computador
- โ Funciona offline una vez descargados los modelos

---

**Este flujo garantiza procesamiento eficiente, seguro y 100% privado de tus archivos de audio** ๐
